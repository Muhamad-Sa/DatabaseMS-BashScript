#!/bin/bash

echo -e "\n           Welcome To Our DBMS"

function mainMenu {
  echo -e "\n+-------------Main Menu-------------+"
  echo "Press (1) to Create Database        -->"
  echo "Press (2) to List Databases         -->"
  echo "Press (3) to Connect to Database    -->"
  echo "Press (4) to Drop Database          -->"
  echo "Press (5) to Exit                   -->"
  echo "+-----------------------------------+"
  echo -e "Enter Choice: \c"
  read choice

  case $choice in
    1)  createDatabase ;;
    2)  ls -d */ ; mainMenu ;;
    3)  connectDatbase ;;
    4)  dropDatabase ;;
    5)  exit ;;
    *)  echo "Wrong Choice, Please enter a valid number" ; mainMenu;
  esac
}

function connectDatbase {
  echo -e "Enter Database Name: \c"
  read databaseName
  cd ./$databaseName 2>> ./errorsFile
  if [[ $? == 0 ]]; then
    echo "Database $databaseName was Successfully Selected"
    tablesMenu
  else
    echo "Database $databaseName wasn't found"
    mainMenu
  fi
}


function dropDatabase {
  echo -e "Enter Database Name: \c"
  read databaseName
  rm -r ./$databaseName 2>> ./errorsFile
  if [[ $? == 0 ]]; then
    echo "Database Dropped Successfully"
  else
    echo "Database Not found"
  fi
  mainMenu
}


function tablesMenu {
  echo -e "\n+----------------Table Menu----------------+"
  echo "Press (1) to Create Table                  -->"
  echo "Press (2) to List Tables                   -->"
  echo "Press (3) to Drop Table                    -->"
  echo "Press (4) to Insert into Table             -->"
  echo "Press (5) to Select from Table             -->"
  echo "Press (6) to Delete from Table             -->"
  echo "Press (7) to Update Table                  -->"
  echo "Press (8) to Exit                          -->"
  echo "+-----------------------------------------+"
  echo -e "Enter Choice: \c"
  read choice

  case $choice in
    1)  createTable ;;
    2)  ls .; tablesMenu ;;
    3)  dropTable;;
    4)  insertIntoTable;;
    5)  selectFromTable;;
    6)  deleteFromTable;;
    7)  updateTable;;
    8)  exit ;;
    *)  echo "Wrong Choice, Please enter a valid number" ; tablesMenu;
  esac
}

mainMenu